<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>New time log</title>
<!--    Base bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">

<!--    Datepicker -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>

<!--    Timepicker -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"></script>
</head>
<body>
<div align="center">
    <form action="#" th:action="@{/add}" method="post" th:object="${timelog}">
        <label>Client name:</label>
        <div class="btn-group">
            <div th:each="client: ${listClient}">
                <input type="radio" class="btn-check clientRadioInput" autocomplete="off" th:field="*{clientName}" th:value="${client}">
                <label class="btn btn-outline-primary" th:for="${#ids.prev('clientName')}" th:text="${client}"></label>
            </div>
        </div>

        <br>

        <label>Job name:</label>
        <div class="btn-group" role="group">
            <div th:each="job: ${listJob}">
                <input type="radio" class="btn-check" autocomplete="off" th:field="*{jobName}" th:value="${job}">
                <label class="btn btn-outline-primary" th:for="${#ids.prev('jobName')}" th:text="${job}"></label>
            </div>
        </div>

        <br>

        <label>Project name:</label>
        <div class="btn-group" role="group">
            <div th:each="project: ${listProject}">
                <input type="radio" class="btn-check" th:field="*{projectName}" th:value="${project}">
                <label class="btn btn-outline-primary" th:for="${#ids.prev('projectName')}" th:text="${project}"></label>
            </div>
        </div>

        <br>

        <div class="form-floating mb-3" style="width: 300pt">
            <input type="text" class="form-control" id="floatingInput1"  th:field="*{workItem}"/><br/>
            <label for="floatingInput1">Work item:</label>
        </div>

        <br>

        <div class="form-floating mb-3" style="width: 300pt">
            <input type="text" class="form-control" id="floatingInput2" th:field="*{description}"/><br/>
            <label for="floatingInput2">Description:</label>
        </div>

        <br>

        <div class="row form-group" style="width: 500pt">
            <label class="col-sm-1 col-form-label">Work date</label>
            <div class="col-sm-4">
                <div class="input-group date" id="datepicker">
                    <input type="text" th:field="*{workDate}" class="form-control">
                    <span class="input-group-append">
                            <span class="input-group-text bg-white">
                                <i class="fa fa-calendar"></i>
                            </span>
                    </span>
                </div>
            </div>
        </div>

        <br>

        <label>From time:</label>
        <input type="text" class="timepicker" th:field="*{fromTime}"/><br/>
        <br>
        <label>To time:</label>
        <input type="text" class="timepicker" th:field="*{toTime}"/><br/>
        <br>
        <label>Billable?</label>
        <input type="checkbox" th:field="*{billable}"/><br/>
        <br>

        <label id="probaOutput">Nothing</label>

        <button type="submit">Submit</button>
    </form>
</div>
<!-- Script -->
<script>
    function getSelectedClient() {
        let clientButtons = document.getElementsByClassName('clientRadioInput');
        for (let i = 0; i < clientButtons.length; i++) {
            let btn = clientButtons.item(i);
            btn.addEventListener('click', () => {
                if (btn.checked) {
                    refreshJobLabels(btn.value);
                }
            });
        }
    }

    function getJobs(clientName)
    {
        let baseUrl = 'http://localhost:8080/jobs/';
        let query = '?clientName='.concat(clientName);
        let requestUrl = baseUrl.concat(query);
        const xmlHttp = new XMLHttpRequest();
        xmlHttp.open( "GET", requestUrl, false ); // false for synchronous request
        xmlHttp.send( null );
        return xmlHttp.responseText;
    }

    function refreshJobLabels(clientName) {
        let clientJobs = getJobs(clientName);

    }

    getSelectedClient();

<!--    Working v1 -->
    $(function () {
        $('#datepicker').datepicker({
            weekStart: 1,
            todayBtn: "linked",
            clearBtn: true,
            multidate: true,
            daysOfWeekDisabled: "0,6",
            todayHighlight: true
        });
        $('.timepicker').timepicker({
            timeFormat: 'h:mm p',
            interval: 10,
            minTime: '10',
            maxTime: '6:00pm',
            defaultTime: '11',
            startTime: '08:00',
            dynamic: false,
            dropdown: true,
            scrollbar: true
        });
    });
</script>
</body>
</html>